{% extends 'base.html.twig' %}

{% block content %}
    {% include 'forum.html.twig' %}
<script type="text/javascript" src="{{ asset('forum/ckeditor/ckeditor.js') }}"></script>

<div class="container">
    <div class="userinfo ">
        <div class="avatar">
            <img src="{{ asset('uploads/avatar/'~User.avatar) }}" alt="" style=" height:5vw ;  max-height: 5vw; max-width:5vw;" />
        </div>

        <div class="icons">
        </div>
    </div>
    <br>

    <form action="{{ path("ajouter_sujet",{'id': plante.id} ) }}"  method="post">

        <div>
            {% if is_granted("IS_AUTHENTICATED_REMEMBERED") %}
                <textarea name="postoriginal"  id="content" rows="10" cols="80" placeholder="Ajouter un commentaire"></textarea>
            {% endif %}
            <script type="text/javascript">
                CKEDITOR.replace('content');
            </script>

        </div>

        <br>

        <input type="submit" class="btn btn-primary pull-left" value="Poser Sujet" onclick="nouveauContenu();" style="border: 1px solid #43a047 ; background-color:#66bb6a; "/>

        <script type="text/javascript">
            function nouveauContenu(){
                //CKEDITOR.instances.content.updateElement();
                document.getElementById('demo').innerHTML =CKEDITOR.instances.content.getData();

            }
        </script>

    </form>

</div>

<br>

        <div class="container">
            <h3> Liste du sujet de la plante {{ plante.nom }} :</h3>
            <br>
            {% for sujet in sujets %}
                <!-- POST -->
                <div class="post">
                    <div class="wrap-ut pull-left">
                        <div class="userinfo pull-left">
                            <div class="avatar">
                                <img src="{{ asset('uploads/avatar/'~sujet.User.avatar) }}" alt="" style=" height:5vw ;  max-height: 5vw; max-width:5vw;" />
                            </div>

                            <div class="icons">
                            </div>
                        </div>
                        <div class="posttext pull-left">
                            <h2><a href="{{ path("consulter_membre",{'id': sujet.user.id} ) }}"> {{  sujet.user.prenom }} {{  sujet.user.nom }} </a></h2>
                            <a href="{{ path("consulter_sujet",{'id': sujet.id} ) }}">  {{ sujet.sujetOriginal |raw }} </a>
                        </div>
                        <div class="clearfix"></div>
                    </div>
                    <div class="postinfo pull-left">
                        {% if sujet.etat == "resolut" %}
                            <div class="views"> <img style="width: 30px; height: 30px;" src="{{ asset('forum/publication/images/resolut.png') }}" alt="" /> </div>
                        {% elseif sujet.etat =="nonresolut" %}
                            <div class="views"> <img style="width: 30px; height: 30px;" src="{{ asset('forum/publication/images/nonresolut.png') }}" alt="" /> </div>
                        {% else %}
                            <div class="views"> <img style="width: 30px; height: 30px;" src="{{ asset('forum/publication/images/nonresolut.png') }}" alt="" /> </div>
                        {% endif %}
                        <div class="comments">
                            {% for NbReponse in NbReponses %}
                                {% if NbReponse.sujet == sujet %}
                                    <div class="commentbg">
                                        {{ NbReponse.NbReponseC }}
                                        <div class="mark"></div>
                                    </div>
                                {% endif %}
                            {% endfor %}

                        </div>
                        <div class="views"><i class="fa fa-eye"></i> {{ sujet.nbviews }}</div>
                        <div class="time"><i class="fa fa-clock-o"></i> {{ sujet.dateoriginal | date("y/m/d") }}</div>
                    </div>
                    <div class="clearfix"></div>
                </div><!-- POST -->

            {% endfor %}

        </div>
{% endblock %}


